---
title: "Assignment 03 Regressions "
subtitle: "BQOM 2578 | Data Mining"
date: "September 28, 2025" 
author: "Theresa Wohlever"
editor: source
format:
  pdf:
    toc: true
    toc-depth: 2
    number-sections: false
    mainfont: "Georgia"
    sansfont: "Avenir"
    monofont: "Menlo"
    mathfont: "STIX Two Math"
    pdf-engine: xelatex
---


# Assignment Instructions

https://canvas.pitt.edu/courses/324587/assignments/1871892

Define and describe the purpose of your analysis in terms of the output and input variable(s) you are interested in understanding for your project and if each variable is categorical or continuous.

Prepare your dataset for running the adequate regression.

Run at least three regressions, at least one linear and one logistic.

Decide how to present your final results; one model, several models? Which format? What graphs / visualizations would you use?

In the last section, describe your final conclusions grounded on your regression analysis and visualizations.


# Executive Summary

For Each variable is it categorical or continuous?
3 regressions on data
evaluate models


# Data Preparation

## Loading packages

```{r}
#| label: LoadPackages
#| echo: false
#| message: false
#| results: 'hide'

rm(list = ls())

library(caTools)
library(ROCR)
library(caret)
library(tidyverse)
library(corrplot)
library(tidyverse)
library("lm.beta")

working_directory <- "/Users/theresawohlever/git_repos/BQOM-2578_DataMining/BQOM-2578_DataMining_twohlever/assignments/03-Regressions"
setwd(working_directory)

CSV_base_filename <- "IHME-GBD_2021_DATA-dcd5bf12-1"
CSV_IN_FILE <- paste(working_directory, "/", "raw_data/", CSV_base_filename, ".csv", sep = "")
CSV_OUT_FILE <- paste(working_directory, "/", CSV_base_filename, "_processed.csv", sep = "")

```


## Importing data

```{r}
#| label: ImportData
#| echo: false
#| message: false
#| results: 'hide'

# read.csv will read the csv into a dataframe, which we can manipulate in R.
ihme_raw_df = read.csv(CSV_IN_FILE, stringsAsFactors = TRUE)

head(ihme_raw_df)
summary(ihme_raw_df)

```



## Data Cleaning & Wrangling

```{r}
#| label: CreateTarget
#| echo: true
#| message: true

# Clean out columns duplicated with id's
df <- ihme_raw_df[, !names(ihme_raw_df) %in% c("measure_name", "location_name", "sex_name", "age_name", "cause_name", "rei_name", "metric_name")]

# Create Target; Isolate Mental Disorder
df <- df %>% mutate(IsMentalDisorder = ifelse(cause_id == 558, 1, 0))

# Remove column name used to determine target value
df$cause_id <- NULL


# Wrangle
# df$Deaths <- as.factor(df$Deaths)           # convert to Factor
# df$Date<-ymd(df$Date)                 # properly interrupt date field

```



```{r}
#| label: ReviewData
#| echo: true
#| message: true

summary(df)


```


## Preliminary Analysis

Evaluate Correlation Matrix

```{r}
#| label: ReviewCorrelationMatrix
#| echo: true
#| message: true
#| fig-width: 7
#| fig-height: 11

df <-df %>% relocate(IsMentalDisorder)  # moves the target variable to the first column (left hand side)
cor_mat <- cor(df)

cor_mat_plot <- round(cor_mat, 2)
cor_mat_plot[is.na(cor_mat_plot)] <- 0 # Replace all NA values with zero
corrplot(cor_mat_plot, method="number", type="upper", diag=FALSE)


```


# Regression

## Linear Regression

```{r}
#| label: LinearRegression1
#| echo: true
#| message: true

m_sex<-lm(IsMentalDisorder ~ sex_id, data=df)
summary(m_sex)

m_sex_age <-lm(IsMentalDisorder ~ sex_id + age_id, data=df)
summary(m_sex_age)

anova(m_sex, m_sex_age)

```


### Stepwise Linear Regression

```{r}
#| label: StepwiseRegression
#| echo: true
#| message: true

model <- lm(IsMentalDisorder ~ ., data = df)
summary(model)

# Perform stepwise regression
#direction can be both, backward or forward
#trace can be set to 0 to only display final result or higher to display more information
step_model <- step(model, direction = "backward",trace=999)
#backward starts with everything and drops non-significant values. 


# View the summary of the stepwise model
summary(step_model)

#For more info: https://www.rdocumentation.org/packages/stats/versions/3.6.2/topics/step 

```


# References

Global Burden of Disease Collaborative Network. Global Burden of Disease Study 2021 (GBD 2021) Results. Seattle, United States: Institute for Health Metrics and Evaluation (IHME), 2022. Available from https://vizhub.healthdata.org/gbd-results/.

